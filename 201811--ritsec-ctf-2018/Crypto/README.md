# Crypto
## CictroHash
çµ¦å‡ºäº†ä¸€å€‹å“ˆå¸Œç®—æ³•çš„æè¿°æ–‡æª”ï¼Œè¦æ±‚çµ¦å‡ºä¸€å€‹ç¢°æ’ã€‚æŒ‰ç…§æ–‡æª”å¯¦ç¾å“ˆå¸Œç®—æ³•ä¹‹å¾Œæš´åŠ›æœç´¢å³å¯ã€‚

## Nobody uses the eggplant emoji
æ„Ÿè¦ºæ­¸éŒ¯äº†é¡ï¼Œé›£é»ä¸åœ¨æ–¼åŠ è§£å¯†ï¼Œåœ¨æ–¼çŒœå‡ºé¡Œè€…çš„è…¦æ´å˜›ã€‚

é¡Œç›®çµ¦å‡ºçš„æ˜¯ä¸€å †emojiæ–‡å­—ï¼Œå®Œå…¨ä¸æ˜æ‰€ä»¥ï¼Œèªªæœ€å¾Œflagæ˜¯RITSEC{key}ï¼Œæ‰€ä»¥æ‡‰è©²æ˜¯ä¸€å€‹åŠ å¯†çš„é¡Œç›®ï¼Œè¦æŠŠå¯†é‘°æåˆ°ã€‚

çµ±è¨ˆäº†ä¸€ä¸‹ï¼Œå…±æœ‰27å€‹ç¬¦è™Ÿï¼ˆç®—ä¸ŠåŸæœ¬å°±æœ‰çš„ä¸‹åŠƒç·šï¼‰ï¼Œæ‰€ä»¥çŒœæ¸¬æ¯å€‹emojiå°æ‡‰ä¸€å€‹è‹±æ–‡å­—ç¬¦ã€‚å…ˆéš¨æ„å®šç¾©ä¸€å€‹æ˜ å°„ï¼Œå¾—åˆ°ASCIIå½¢å¼çš„å¯†æ–‡ï¼š

```python
emojis = 'ğŸ¤ğŸ‘¿ğŸ¤“ğŸ¥‡ğŸ¼ğŸ’©ğŸ¤“ğŸš«ğŸ’ªğŸ¤ğŸ—£ğŸ™„ğŸ¤“ğŸ¥‡ğŸ¼ğŸ’©ğŸ¤“ğŸ˜€âœ…ğŸ˜ŸğŸ¤“ğŸğŸ¼âœ…ğŸš«ğŸ’ªğŸ¥‡ğŸ¤“ğŸ¼ğŸ‘¿ğŸ¤“ğŸš«ğŸ’ªğŸ˜ŸğŸ¤“ğŸ‘¿ğŸ˜¾ğŸ˜€ğŸ˜¯ğŸ¤“ğŸ‘¿ğŸ¤âœ…ğŸ”¥ğŸš«ğŸ¤“ğŸ¥‡ğŸ¼ğŸ’©ğŸ¤“ğŸ‘»ğŸ’©ğŸ”¥ğŸš«ğŸ¤“ğŸ˜€ğŸ—£ğŸ”¥ğŸğŸ˜Ÿâœ…ğŸ¤“ğŸš«ğŸ’ªğŸ˜ŸğŸ”¥ğŸ˜ŸğŸ¤“ğŸš«ğŸ’ªâœ…ğŸ˜ŸğŸ˜ŸğŸ¤“ğŸ’”ğŸ’©ğŸ˜ŸğŸ”¥ğŸš«ğŸ¤ğŸ¼ğŸ—£ğŸ”¥ğŸ˜­ğŸ¤“ğŸğŸ’ªğŸ˜€ğŸš«ğŸ¤“ğŸ¤ğŸ”¥ğŸ¤“ğŸ¥‡ğŸ¼ğŸ’©ğŸ¤“ğŸ—£ğŸ˜€ğŸ‘»ğŸ˜ŸğŸ¤¢ğŸ¤“ğŸğŸ’ªğŸ˜€ğŸš«ğŸ¤“ğŸ¤ğŸ”¥ğŸ¤“ğŸ¥‡ğŸ¼ğŸ’©âœ…ğŸ¤“ğŸ’”ğŸ’©ğŸ˜ŸğŸ”¥ğŸš«ğŸ¤¢ğŸ¤“ğŸğŸ’ªğŸ˜€ğŸš«ğŸ¤“ğŸ¤ğŸ”¥ğŸ¤“ğŸš«ğŸ’ªğŸ˜ŸğŸ¤“ğŸ˜€ğŸ¤âœ…ğŸ¤“ğŸ”¥ğŸ™ğŸ˜ŸğŸ˜ŸğŸ˜ğŸ¤“ğŸ‘€ğŸ˜ŸğŸ˜¾ğŸ¼ğŸ¤¬ğŸ¤ğŸš«ğŸ¥‡ğŸ¤“ğŸ¼ğŸ‘¿ğŸ¤“ğŸ˜€ğŸ—£ğŸ¤“ğŸ’©ğŸ—£ğŸ˜¾ğŸ˜€ğŸ˜ğŸ˜ŸğŸ—£ğŸ¤“ğŸ”¥ğŸğŸ˜€ğŸ˜¾ğŸ˜¾ğŸ¼ğŸğŸ˜­ğŸ¤“ğŸ¥‡ğŸ¼ğŸ’©âœ…ğŸ¤“ğŸ‘¿ğŸ˜¾ğŸ˜€ğŸ˜¯ğŸ¤“ğŸ¤ğŸ”¥ğŸ¤¡ğŸ¤“ğŸ˜€ğŸ‘¿âœ…ğŸ¤ğŸ¤¬ğŸ˜€ğŸ—£_ğŸ¼âœ…_ğŸ˜ŸğŸ’©âœ…ğŸ¼ğŸ™ğŸ˜ŸğŸ˜€ğŸ—£_ğŸ”¥ğŸğŸ˜€ğŸ˜¾ğŸ˜¾ğŸ¼ğŸ_ğŸğŸ¼ğŸ_ğŸš«ğŸ’ªğŸ˜Ÿâœ…ğŸ˜ŸğŸ”¥_ğŸ˜€_ğŸ˜ğŸ¤ğŸ‘¿ğŸ‘¿ğŸ˜Ÿâœ…ğŸ˜ŸğŸ—£ğŸ¤¬ğŸ˜ŸğŸ¤“'

emoji_set = set()
for c in emojis:
    if c not in emoji_set:
        emoji_set.add(c)
print(len(emoji_set))  # 27

table = {'_':'_'}
i = 0
for c in emojis:
    if c not in table:
        emoji_set.add(c)
        table[c] = chr(ord('a') + i)
        i += 1

s = ''
for c in emojis:
    s += table[c]
print(s)
```
å¾—åˆ°ï¼š
```bash
abcdefcghaijcdefcklmcnelghdcebcghmcbokpcbalqgcdefcrfqgckiqnmlcghmqmcghlmmcsfmqgaeiqtcnhkgcaqcdefcikrmucnhkgcaqcdeflcsfmqgucnhkgcaqcghmckalcqvmmwcxmoeyagdcebckicfiokwmicqnkooentcdeflcbokpcaqzckblayki_el_mflevmki_qnkooen_nen_ghmlmq_k_wabbmlmiymc
```

[åœ¨ç·šè§£å¯†](https://www.guballa.de/substitution-solver)ä¸€ä¸‹å¾—åˆ°ï¼š
```bash
ifsyousthingsyousaresworthysofsthesflamsfirdtsyousjudtsandwersthedesthreesquedtiondpswhatsidsyousnajevswhatsidsyoursquedtvswhatsidsthesairsdbeekszelocitysofsansunlakensdwallowpsyoursflamsidxsafrican_or_eurobean_dwallow_wow_thered_a_kifferences
```

å¯ä»¥çœ‹åˆ°å¤§æ¦‚çš„çµæœäº†ï¼Œé‚„éœ€è¦æ‰‹å‹•èª¿æ•´ä¸€ä¸‹ï¼Œæ¯”å¦‚sæ›æˆç©ºæ ¼ï¼Œkæ›æˆdç­‰ï¼Œ[é€™å€‹ç¶²ç«™](https://www.dcode.fr/monoalphabetic-substitution)å¯ä»¥è®“æˆ‘å€‘é€²è¡Œå¯è¦–åŒ–çš„èª¿æ•´ï¼Œæœ€å¾Œçµæœï¼š
```bash
if you think you are worthy of the flag first you must answer these three questions. what is you name? what is your quest? what is the air speed velocity of an unladen swallow. your flag is: african_or_european_swallow_wow_theres_a_difference
```
ç›´æ¥å¾—åˆ°äº†flagã€‚

1. æ›¿æ›å¯†ç¢¼åœ¨ç·šè§£å¯†ï¼šhttps://www.guballa.de/substitution-solver
2. æ›¿æ›å¯†ç¢¼å‹•æ…‹è§£å¯†ï¼šhttps://www.dcode.fr/monoalphabetic-substitution
3. åƒè€ƒWriteupï¼šhttps://medium.com/@ajdumanhug/ritsec-ctf-2018-writeup-miscforcry-f87812683227

## The Proof is in the PÃ¼dding
å•¥ä¹Ÿæ²’èªªï¼Œåªçµ¦äº†ä¸€é pdfï¼Œè£é¢æ˜¯ä¸€ç³»åˆ—ç·¨è™Ÿçš„èšé¡åœ–ï¼ŒçŒœä¸åˆ°ä½œè€…è…¦å›è·¯ï¼Œéœç­‰å¤§ç¥çš„writeupå§ã€‚

## Lost In Transmission
çµ¦äº†ä¸€å€‹å­—ç¬¦ä¸²ï¼Œçœ‹ä¸Šå»åƒbase64åŠ å¯†ï¼Œè§£å¯†å¾—åˆ°01ä¸²ï¼š
```bash
$ echo MTAxMTAxMDEwMTExMDEwMTAwMTAxMDEwMTExMTAxMDEwMTEwMTAxMDAxMDExMDEwMTAwMTExMTAxMDEwMTExMDAxMDEwMTAxMTEwMDEwMTAxMDEwMDExMDEwMTAwMDAwMDAxMDEwMTAwMTExMTAxMDEwMDAwMDAxMDEwMTAwMDAwMDEwMTAxMDEwMDExMDEwMTAwMDAwMDAxMDEwMTAwMTExMTAxMDEwMDAwMDAxMDEwMTAwMDAwMDEwMTAxMDEwMDExMDEwMTAwMDAwMDAxMDEwMTAwMTExMTAxMDEwMTExMDAxMDEwMTAxMTEwMDEwMTAxMDEwMDExMDEwMTA= | base64 -d
10110101011101010010101011110101011010100101101010011110101011100101010111001010101001101010000000101010011110101000000101010000001010101001101010000000101010011110101000000101010000001010101001101010000000101010011110101011100101010111001010101001101010$ echo MTAxMTAxMDEwMTExMDEwMTAwMTAxMDEwMTExMTAxMDEwMTEwMTAxMDAxMDExMDEwMTAwMTExMTAxMDEwMTExMDAxMDEwMTAxMTEwMDEwMTAxMDEwMDExMDEwMTAwMDAwMDAxMDEwMTAwMTExMTAxMDEwMDAwMDAxMDEwMTAwMDAwMDEwMTAxMDEwMDExMDEwMTAwMDAwMDAxMDEwMTAwMTExMTAxMDEwMDAwMDAxMDEwMTAwMDAwMDEwMTAxMDEwMDExMDEwMTAwMDAwMDAxMDEwMTAwMTExMTAxMDEwMTExMDAxMDEwMTAxMTEwMDEwMTAxMDEwMDExMDEwMTA= | base64 -d | decode.py bin
b'-]J\xbdZ\x96\xa7\xab\x95r\xa9\xa8\n\x9e\xa0T\n\xa6\xa0*z\x81P*\x9a\x80\xa9\xea\xe5\\\xaaj'
```

ä¸‹é¢çŒœä¸å‡ºäº†ï¼Œä¸æµªè²»æ™‚é–“äº†ï¼Œéœç­‰å¤§ç¥ã€‚

## Who drew on my program?
![program.png](./Crypto/05--program/crypto.png)

å¯ä»¥æå–å¦‚ä¸‹ä¿¡æ¯ï¼š
1. AESåŠ å¯†ï¼ŒCBCæ¨¡å¼
2. æ˜æ–‡å·²çŸ¥ï¼š'The message is protected by AES!'ï¼ˆ32å­—èŠ‚ï¼‰
3. å¯†é‘°(K='9aF738g9AkI112??')æœ€å¾Œ2ä¸ªå­—èŠ‚æœªçŸ¥ã€‚
4. IVæœªçŸ¥ã€‚
5. å¯†æ–‡ä¸­é–“13å­—èŠ‚æœªçŸ¥('9e??????????????????????????436a808e200a54806b0e94fb9633db9d67f0'(hexilified))ã€‚

ç”±æ–¼æ˜¯CBCæ¨¡å¼ï¼Œæ‰€ä»¥å¯¦éš›ä¸Šæ˜¯å…©æ¬¡AESåŠ å¯†ï¼š
1. ç¬¬ä¸€æ¬¡ï¼Œæ˜æ–‡P1='The message is p'ï¼Œèˆ‡æœªçŸ¥IVç•°æˆ–ï¼Œç¶“å¯†é‘°Kçš„AESåŠ å¯†ï¼Œå¯†æ–‡C1='9e??????????????????????????436a'(hexilified)ã€‚
2. ç¬¬äºŒæ¬¡ï¼Œæ˜æ–‡P2='rotected by AES!'ï¼Œèˆ‡C1ç•°æˆ–ï¼Œç¶“å¯†é‘°Kçš„AESåŠ å¯†ï¼Œå¯†æ–‡C2='808e200a54806b0e94fb9633db9d67f0'(hexilified)ã€‚

è§£å¯†æ™‚ï¼š
1. å°‡C1ç”¨Kè§£å¯†ï¼Œèˆ‡IVç•°æˆ–å¾—åˆ°P1ã€‚
2. å°‡C2ç”¨Kè§£å¯†ï¼Œèˆ‡C1ç•°æˆ–å¾—åˆ°P2ã€‚

å¾ˆæ˜é¡¯ç¬¬äºŒå€‹åˆ†çµ„æœ‰æ›´å¤šçš„ä¿¡æ¯ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°C2ç”¨Kè§£å¯†å¾Œçš„ç¬¬0\14\15å€‹å­—ç¯€ï¼Œè€ŒC2å·²çŸ¥ï¼ŒKåªæœ‰å…©å€‹å­—ç¯€æœªçŸ¥ï¼Œæ–¼æ˜¯å¯ä»¥ç›´æ¥çª®èˆ‰çŒœè§£å¾—åˆ°æ­£ç¢ºçš„Kã€‚å¾—åˆ°Kçš„åŒæ™‚C1ä¹Ÿå°±å·²çŸ¥äº†ï¼Œç”¨Kè§£å¯†C1ï¼Œç„¶å¾Œèˆ‡P1ç•°æˆ–ï¼Œå³å¯å¾—åˆ°IVã€‚
```python
bKEY = '9aF738g9AkI112'
p1 = b"The message is p"
p2 = b"rotected by AES!"
c1 = binascii.a2b_hex(b'9e00000000000000000000000000436a')
c2 = binascii.a2b_hex(b'808e200a54806b0e94fb9633db9d67f0')

for i in itertools.product(string.printable, repeat=2):
    eKEY = ''.join(i)
    KEY = bKEY + eKEY
    KEY = KEY.encode()
    aes = AES.new(KEY, AES.MODE_CBC, b'\x00'*16)
    xor = aes.decrypt(c2)
    if xor[0] == p2[0] ^ c1[0] and xor[14] == p2[14] ^ c1[14] and xor[15] == p2[15] ^ c1[15]:
        print("Got KEY: ", KEY)
        c1 = b''
        for i in range(16):
            c1 += (p2[i] ^ xor[i]).to_bytes(1, 'little')
        print('c1 =', c1)

        aes = AES.new(KEY, AES.MODE_CBC, b'\x00'*16)
        xor = aes.decrypt(c1)
        IV = b''
        for i in range(16):
            IV += (p1[i] ^ xor[i]).to_bytes(1, 'little')
        print('IV =', IV)
```

## DarkPearAI
è¬ä¹‹é¡Œå¹¹ï¼š
```
3:371781196966866977144706219746579136461491261

Person1: applepearblue
Person2: darkhorseai

What is their secret key?
(Submit like RITSEC{KEY_GOES_HERE})

Hint 1: Hopefully you can get the flag in a <s>diffie</s> jiffy!

Hint 2: If you can type at a decent pace this challenge can be completed in under 30 seconds
```

çœ‹äº†åˆ¥äººçš„ç­”æ¡ˆæ‰çŸ¥é“æ˜¯Diffie-Hellmanï¼Œå¥½å§ï¼ŒHint1æˆ‘æ²’æœ‰å®Œå…¨é ˜æœƒï¼Œä½†æ˜¯åœ¨é€™è£å¡é€™éº¼ä¸€é“çœŸçš„æœ‰æ„æ€éº¼ï¼Ÿ
```
g = 3
n = 371781196966866977144706219746579136461491261
Person1: applepearblue
Person2: darkhorseai
```

é‡æº«ä¸€ä¸‹DFå¯†é‘°äº¤æ›è¦é»ï¼šåˆ©ç”¨é›¢æ•£å°æ•¸ï¼Œæˆ´é‡‘ç®å®¹æ˜“æ‘˜é‡‘ç®é›£ã€‚
1. Aé¸æ“‡$a$ï¼Œç™¼é€$g^a$ï¼›
2. Bé¸æ“‡$b$ï¼Œç™¼é€$g^b$ï¼›
3. ABå°‡$K=g^{ab}$ä½œçˆ²å¯†é‘°ã€‚

ç”±æ–¼é€™è£næ¯”è¼ƒå°ï¼Œæ‡‰è©²å¯ä»¥ç”¨sageç›´æ¥è¨ˆç®—é›¢æ•£å°æ•¸ï¼š
```sage
n=371781196966866977144706219746579136461491261
F = IntegerModRing(n)

g=3
ga = int(binascii.hexlify('applepearblue'.encode()), base=16)  # 7719929996562228520753654691173
gb = int(binascii.hexlify('darkhorseai'.encode()), base=16)  # 121352762178684172934406505

a = discrete_log(F(ga), F(g))
b = discrete_log(F(gb), F(g))

print('RITSEC{'+str(IntegerModRing(n)(g)**(a*b))+'}')
```
æ²’æƒ³åˆ°å ±éŒ¯ï¼šâ€œNo discrete log of 7719929996562228520753654691173 found to base 3â€ã€‚

å·¦æ€å³æƒ³ä¸æ˜ç™½ï¼Œåªå¥½åˆç¹¼çºŒçœ‹åˆ¥äººçš„ç­”æ¡ˆï¼ŒåŸä¾†applepearblueè®Šæˆ10é€²åˆ¶æ•¸çš„æ–¹æ³•æ˜¯é€™æ¨£çš„ï¼šç›´æ¥å°‡æ¯å€‹å­—æ¯è®Šæˆ10é€²åˆ¶æ•¸å­—æœ€å¾Œæ‹¼æ¥ï¼Œè€Œä¸æ˜¯æˆ‘é‚£æ¨£å°‡æ¯å€‹å­—æ¯è®Šæˆ16é€²åˆ¶æ‹¼æ¥å¾Œè½‰æ›çˆ²10é€²åˆ¶ã€‚æ–¼æ˜¯ï¼š
```sage
ga = 97112112108101112101097114098108117101
gb = 100097114107104111114115101097105
```

æœ¬é¡Œæ˜¯å¯†ç¢¼é¡Œåˆ†å€¼æœ€é«˜çš„é¡Œï¼ˆ500åˆ†ï¼‰ï¼ŒDFäº¤æ›ä¸æ˜¯é›£é»ï¼Œå…©å€‹è…¦æ´çº”æ˜¯å¾—åˆ†é—œéµã€‚
